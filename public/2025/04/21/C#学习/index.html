<!DOCTYPE html>
<html lang="en">
    
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover" name="viewport" />
    <meta name="description" content="" />
    <meta name="hexo-theme-A4" content="v1.9.7" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>段恺乐</title>

    
        
<link rel="stylesheet" href="/css/highlight/style1.css">

        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--注意：首页既不是post也不是page-->
        
        
        
<link rel="stylesheet" href="/css/ui.css">
 
        
<link rel="stylesheet" href="/css/style.css">


        
            <!--返回顶部css-->
            
<link rel="stylesheet" href="/css/returnToTop.css">

            
<link rel="stylesheet" href="/css/unicons.css">

        
        
            <!--目录-->
            
<link rel="stylesheet" href="/css/toc.css">

        
    

    
        
<link rel="stylesheet" href="/css/returnToLastPage.css">

    
    
   
<link rel="stylesheet" href="/css/lightgallery-bundle.min.css">


<meta name="generator" content="Hexo 7.3.0"></head>
    
    

    
    



    

    
    

    
    
    
    <body>
        <script src="/js/darkmode-js.min.js"></script>
        
        <script>
            const options = {
                bottom: '40px', // default: '32px'
                right: 'unset', // default: '32px'
                left: '42px', // default: 'unset'
                time: '0.3s', // default: '0.3s'
                mixColor: '#fff', // default: '#fff'
                backgroundColor: ' #e4e4e4 ',  // default: '#fff'
                buttonColorDark: '#100f2c',  // default: '#100f2c'
                buttonColorLight: '#fff', // default: '#fff'
                saveInCookies: true, // default: true,
                label: '🌓', // default: ''
                autoMatchOsTheme: true // default: true
            }
            const darkmode = new Darkmode(options);
            darkmode.showWidget();
        </script>
        
        
            <div class="left-toc-container">
                <nav id="toc" class="bs-docs-sidebar"></nav>
            </div>
        
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    


<div class="header">
    <div class="header-container">
        <style>
            .header-img {
                width: 56px;
                height: auto;
                object-fit: cover; /* 保持图片比例 */
                transition: transform 0.3s ease-in-out; 
                border-radius: 50%; 
            }
            
        </style>
        <img 
            alt="^-^" 
            cache-control="max-age=86400" 
            class="header-img" 
            src="/img/favicon.webp" 
        />
        <div class="header-content">
            <a class="logo" href="/">段恺乐</a> 
            <span class="description">声音设计师丨音乐制作爱好者</span> 
        </div>
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">首页</a></li>
            
        
            
                <li><a href="/works/">作品</a></li>
            
        
            
                <li><a href="/about/">关于</a></li>
            
        
            
                <li><a href="/list/">文章</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--说明是文章post页面-->
                    
                        <div class="post-main">
    

    
        
            
                <div class="post-main-title" style="text-align: center;">
                    
                </div>
            
        
      
    

    

        
            <div class="post-head-meta-center">
        
                
                    <span>最近更新：2025-01-21</span> 
                
                
                    
                        &nbsp; | &nbsp;
                    
                     <span>字数总计：8.4k</span>
                
                
                    
                        &nbsp; | &nbsp;
                    
                    <span>阅读估时：38分钟</span>
                
                
                    
                        &nbsp; | &nbsp;
                    
                    <span id="busuanzi_container_page_pv">
                        阅读量：<span id="busuanzi_value_page_pv"></span>次
                    </span>
                
            </div>
    

    <div class="post-md">
        
            
                <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#title-C-%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0"><span class="post-toc-text">title&#x3D; C#学习笔记</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Type%EF%BC%88%E7%B1%BB%E5%9E%8B%EF%BC%89"><span class="post-toc-text">Type（类型）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%B1%BB%E5%9E%8B%E7%9A%84%E7%AE%80%E4%BB%8B"><span class="post-toc-text">类型的简介</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F"><span class="post-toc-text">类型系统</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%BA%94%E5%A4%A7%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="post-toc-text">五大数据类型</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%8F%98%E9%87%8F%E3%80%81%E5%AF%B9%E8%B1%A1%E4%B8%8E%E5%86%85%E5%AD%98"><span class="post-toc-text">变量、对象与内存</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8F%98%E9%87%8F"><span class="post-toc-text">变量</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%80%BC%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%8F%98%E9%87%8F"><span class="post-toc-text">值类型的变量</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%8F%98%E9%87%8F"><span class="post-toc-text">引用类型的变量</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E8%A3%85%E7%AE%B1-%E6%8B%86%E7%AE%B1"><span class="post-toc-text">装箱&#x2F;拆箱</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#Method-%E6%96%B9%E6%B3%95"><span class="post-toc-text">Method(方法)</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%94%B1%E6%9D%A5"><span class="post-toc-text">由来</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%A3%B0%E6%98%8E%E4%B8%8E%E8%B0%83%E7%94%A8"><span class="post-toc-text">声明与调用</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%EF%BC%88%E6%9E%84%E9%80%A0%E5%99%A8-constructor%EF%BC%89"><span class="post-toc-text">构造函数（构造器&#x2F;constructor）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%96%B9%E6%B3%95%E7%9A%84%E9%87%8D%E8%BD%BD%EF%BC%88Overload%EF%BC%89"><span class="post-toc-text">方法的重载（Overload）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%96%B9%E6%B3%95%E7%9A%84debug"><span class="post-toc-text">方法的debug</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%96%B9%E6%B3%95%E7%9A%84%E8%B0%83%E7%94%A8%E4%B8%8E%E6%A0%88"><span class="post-toc-text">方法的调用与栈</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E6%93%8D%E4%BD%9C%E7%AC%A6%EF%BC%88Operator%EF%BC%89"><span class="post-toc-text">操作符（Operator）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="post-toc-text">概述</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E5%AD%97%E6%AE%B5%E3%80%81%E5%B1%9E%E6%80%A7%E3%80%81%E5%B8%B8%E9%87%8F%E3%80%81%E7%B4%A2%E5%BC%95%E5%99%A8"><span class="post-toc-text">字段、属性、常量、索引器</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%AD%97%E6%AE%B5%EF%BC%88field%EF%BC%89"><span class="post-toc-text">字段（field）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%B1%9E%E6%80%A7%EF%BC%88property%EF%BC%89"><span class="post-toc-text">属性（property）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%B4%A2%E5%BC%95%E5%99%A8"><span class="post-toc-text">索引器</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%B8%B8%E9%87%8F%EF%BC%88constant%EF%BC%89"><span class="post-toc-text">常量（constant）</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%90%84%E7%A7%8D%E2%80%9C%E5%8F%AA%E8%AF%BB%E2%80%9D"><span class="post-toc-text">各种“只读”</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E5%8F%82%E6%95%B0"><span class="post-toc-text">参数</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%80%BC%E5%8F%82%E6%95%B0"><span class="post-toc-text">值参数</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%BC%95%E7%94%A8%E5%8F%82%E6%95%B0"><span class="post-toc-text">引用参数</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E8%BE%93%E5%87%BA%E5%BD%A2%E5%8F%82"><span class="post-toc-text">输出形参</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%85%B7%E5%90%8D%E8%B0%83%E7%94%A8"><span class="post-toc-text">具名调用</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%8F%AF%E9%80%89%E5%8F%82%E6%95%B0"><span class="post-toc-text">可选参数</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%89%A9%E5%B1%95%E6%96%B9%E6%B3%95%EF%BC%88This"><span class="post-toc-text">扩展方法（This)</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%A7%94%E6%89%98%EF%BC%88delegate%EF%BC%89"><span class="post-toc-text">委托（delegate）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Action%E5%A7%94%E6%89%98%E5%AE%9E%E4%BE%8B"><span class="post-toc-text">Action委托实例</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Func%E5%A7%94%E6%89%98%E5%AE%9E%E4%BE%8B"><span class="post-toc-text">Func委托实例</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%A7%94%E6%89%98%E7%9A%84%E5%A3%B0%E6%98%8E"><span class="post-toc-text">委托的声明</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%A7%94%E6%89%98%E7%9A%84%E4%BD%BF%E7%94%A8"><span class="post-toc-text">委托的使用</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%A7%94%E6%89%98%E4%BD%BF%E7%94%A8%E7%9A%84%E6%A1%88%E4%BE%8B"><span class="post-toc-text">委托使用的案例</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%9B%9E%E8%B0%83Callback%E6%96%B9%E6%B3%95%E6%A1%88%E4%BE%8B"><span class="post-toc-text">回调Callback方法案例</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%A7%94%E6%89%98%E4%BD%BF%E7%94%A8%E7%9A%84%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="post-toc-text">委托使用的注意点</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%A4%9A%E6%92%AD%E5%A7%94%E6%89%98%EF%BC%88multicast%EF%BC%89"><span class="post-toc-text">多播委托（multicast）</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%9A%90%E5%BC%8F%E5%BC%82%E6%AD%A5%E8%B0%83%E7%94%A8"><span class="post-toc-text">隐式异步调用</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E4%BA%8B%E4%BB%B6%EF%BC%88Event%EF%BC%89"><span class="post-toc-text">事件（Event）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%BA%8B%E4%BB%B6%E6%A8%A1%E5%9E%8B%E7%9A%84%E4%BA%94%E4%B8%AA%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86"><span class="post-toc-text">事件模型的五个组成部分</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%BA%8B%E4%BB%B6%E7%9A%84%E5%A3%B0%E6%98%8E"><span class="post-toc-text">事件的声明</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E7%B1%BB%EF%BC%88class%EF%BC%89"><span class="post-toc-text">类（class）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%B1%BB%E7%9A%84%E8%AE%BF%E9%97%AE%E7%BA%A7%E5%88%AB%E4%BF%AE%E9%A5%B0%E7%AC%A6"><span class="post-toc-text">类的访问级别修饰符</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%B1%BB%E7%9A%84%E7%BB%A7%E6%89%BF"><span class="post-toc-text">类的继承</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%B1%BB%E6%88%90%E5%91%98%E7%9A%84%E8%AE%BF%E9%97%AE"><span class="post-toc-text">类成员的访问</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%87%8D%E5%86%99%E4%B8%8E%E5%A4%9A%E6%80%81%EF%BC%88polymorphism%EF%BC%89"><span class="post-toc-text">重写与多态（polymorphism）</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E6%8E%A5%E5%8F%A3%E3%80%81%E6%8A%BD%E8%B1%A1%E7%B1%BB%E3%80%81SOLID%E3%80%81%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%E5%92%8C%E5%8F%8D%E5%B0%84"><span class="post-toc-text">接口、抽象类、SOLID、单元测试和反射</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%8E%A5%E5%8F%A3%E4%B8%8E%E6%8A%BD%E8%B1%A1%E7%B1%BB"><span class="post-toc-text">接口与抽象类</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%8A%BD%E8%B1%A1%E7%B1%BB%E4%B8%8E%E5%BC%80%E6%94%BE%E5%85%B3%E9%97%AD%EF%BC%88%E5%BC%80%E9%97%AD%EF%BC%89%E5%8E%9F%E5%88%99"><span class="post-toc-text">抽象类与开放关闭（开闭）原则</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%8E%A5%E5%8F%A3%EF%BC%88Interface%EF%BC%89%E4%B8%8E%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95"><span class="post-toc-text">接口（Interface）与单元测试</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E4%BE%9D%E8%B5%96%E5%8F%8D%E8%BD%AC-%E5%80%92%E7%BD%AE%E5%8E%9F%E5%88%99%EF%BC%88Dependecy-Inversion%EF%BC%89%EF%BC%9A"><span class="post-toc-text">依赖反转&#x2F;倒置原则（Dependecy Inversion）：</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E6%8E%A5%E5%8F%A3%E9%9A%94%E7%A6%BB%E5%8E%9F%E5%88%99%EF%BC%88Interface-Seperation%EF%BC%89"><span class="post-toc-text">接口隔离原则（Interface Seperation）</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E5%8D%95%E5%85%83%E6%B5%8B%E8%AF%95%EF%BC%9A"><span class="post-toc-text">单元测试：</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%8F%8D%E5%B0%84%E3%80%81%E7%89%B9%E6%80%A7%E5%92%8C%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5%EF%BC%88Dependency-Injection%EF%BC%89"><span class="post-toc-text">反射、特性和依赖注入（Dependency Injection）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%8F%8D%E5%B0%84%EF%BC%88Reflection%EF%BC%89"><span class="post-toc-text">反射（Reflection）</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5"><span class="post-toc-text">依赖注入</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E9%80%9A%E8%BF%87%E5%8F%8D%E5%B0%84%E5%AE%9E%E7%8E%B0%E6%9B%B4%E6%9D%BE%E7%9A%84%E8%80%A6%E5%90%88"><span class="post-toc-text">通过反射实现更松的耦合</span></a></li></ol></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E6%B3%9B%E5%9E%8B%E3%80%81partial%E7%B1%BB%E3%80%81%E6%9E%9A%E4%B8%BE%E3%80%81%E7%BB%93%E6%9E%84%E4%BD%93"><span class="post-toc-text">泛型、partial类、枚举、结构体</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%B3%9B%E5%9E%8B%EF%BC%88generic%EF%BC%89"><span class="post-toc-text">泛型（generic）</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%B3%9B%E5%9E%8B%E7%B1%BB%E5%9E%8B"><span class="post-toc-text">泛型类型</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%B3%9B%E5%9E%8B%E6%8E%A5%E5%8F%A3"><span class="post-toc-text">泛型接口</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%B3%9B%E5%9E%8B%E9%9B%86%E5%90%88"><span class="post-toc-text">泛型集合</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%B3%9B%E5%9E%8B%E6%96%B9%E6%B3%95"><span class="post-toc-text">泛型方法</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%B3%9B%E5%9E%8B%E5%A7%94%E6%89%98"><span class="post-toc-text">泛型委托</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#partial%E7%B1%BB"><span class="post-toc-text">partial类</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%9E%9A%E4%B8%BE"><span class="post-toc-text">枚举</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%BB%93%E6%9E%84%E4%BD%93%EF%BC%88struct%EF%BC%89"><span class="post-toc-text">结构体（struct）</span></a></li></ol></li><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#LINQ%E3%80%81lambda%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%8E%E5%A7%94%E6%89%98"><span class="post-toc-text">LINQ、lambda表达式与委托</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#lambda"><span class="post-toc-text">lambda</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#LINQ-NET-Language-Integrated-Query"><span class="post-toc-text">LINQ(.NET Language Integrated Query)</span></a></li></ol>
            
        
        <div class=".article-gallery"><hr>
<h2 id="title-C-学习笔记"><a href="#title-C-学习笔记" class="headerlink" title="title&#x3D; C#学习笔记"></a>title&#x3D; C#学习笔记</h2><h1 id="Type（类型）"><a href="#Type（类型）" class="headerlink" title="Type（类型）"></a>Type（类型）</h1><h2 id="类型的简介"><a href="#类型的简介" class="headerlink" title="类型的简介"></a>类型的简介</h2><p>小内存容纳大尺寸数据会丢失数据和精度…<br>大内存…小尺寸数据浪费内存<br>整数类型：int 4字节；long 8字节。<br>强类型语言：数据类型不能轻易转变；弱类型语言…<br>程序静止时，放在硬盘（外村）内，运行时，装载到内存。<br>类型中的信息：<br>    内存空间大小，<br>    储存值的大小范围，<br>    基类（父类），<br>    成员（事件，属性，方法）<br>    类型的变量分配在内存的位置<br>        Stack(栈，比较小)&#x2F;Heap(堆，更大)<br>        Stack overflow栈溢出，堆不会溢出。<br>        堆上的内存如果忘记回收，会造成内存泄漏。<br>        cmd中调用performance monitor可以监测进程的内存。<br>        实例，分配到堆（heap）中去。</p>
<h2 id="类型系统"><a href="#类型系统" class="headerlink" title="类型系统"></a>类型系统</h2><h3 id="五大数据类型"><a href="#五大数据类型" class="headerlink" title="五大数据类型"></a>五大数据类型</h3><p>类（class）：Window,Form,Console<br>结构体（structure）:Int,double<br>枚举（enumeration）<br>接口（interface）<br>委托（delegate） </p>
<h2 id="变量、对象与内存"><a href="#变量、对象与内存" class="headerlink" title="变量、对象与内存"></a>变量、对象与内存</h2><h3 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h3><p>变量（名）表示了变量的值存储位置（从这个位置往后数多少节，用以保存这个变量，以其数据类型的要求），并且每个变量都有一个类型，决定什么样的值，能存入变量。<br>例如，int x &#x3D;100;<br>类型：静态变量，实例变量（字段，成员变量），数组元素，值参数，引用参数(ref)，输出形参(out) ，局部变量。<br>狭义的变量，指局部变量（其他种类变量都有自己的约定名称，例如，静态变量称为静态字段）<br>局部变量：方法体，函数体内声明的变量。</p>
<h3 id="值类型的变量"><a href="#值类型的变量" class="headerlink" title="值类型的变量"></a>值类型的变量</h3><p>byte&#x2F;short&#x2F;ushort等<br>值类型的储存：在内存中分配空间存储值。<br>值类型没有实例，实例与变量合而为一了。</p>
<h3 id="引用类型的变量"><a href="#引用类型的变量" class="headerlink" title="引用类型的变量"></a>引用类型的变量</h3><p>引用类型的储存：储存的是对象的地址。<br>例如：<br>Student stu;(分配四个字节的内存，用来指向实例化对象的地址)<br>stu &#x3D;new Student();（开辟一段内存空间，用于储存Student类中的成员）</p>
<p>Class Student()<br>{<br>  unit ID;<br>  string name;<br>}</p>
<h3 id="装箱-拆箱"><a href="#装箱-拆箱" class="headerlink" title="装箱&#x2F;拆箱"></a>装箱&#x2F;拆箱</h3><p>装箱（Boxing）<br>int x&#x3D;100;<br>Object obj &#x3D;x;<br>将栈上的数据搬到堆上，然后将堆上存储这段数据的地址储存到栈上的obj上。<br>拆箱（Unboxing）<br>相反的操作。<br>int y &#x3D;(int)obj;</p>
<h1 id="Method-方法"><a href="#Method-方法" class="headerlink" title="Method(方法)"></a>Method(方法)</h1><h2 id="由来"><a href="#由来" class="headerlink" title="由来"></a>由来</h2><p>由C++和C语言中的function（函数）演变而来。<br>当函数成为类的成员之后，便变为了方法（或成员函数）。方法永远是类（class）的成员。 </p>
<h2 id="声明与调用"><a href="#声明与调用" class="headerlink" title="声明与调用"></a>声明与调用</h2><p>C#声明与定义不分家。<br>声明结构：<br>函数头   函数体<br>函数头：特性  修饰符  （partial）  返回值   函数名  （）<br>    修饰符：有的可以组合<br>静态方法，隶属于类，而非声明的对象。不用实例化即可以调用。<br>例如：<br>Calculator c &#x3D; new Calculator();<br>c.method1();<br>Calculator.method_2();</p>
<p>Class Calculator<br>{<br> public int method()<br> {<br> return 0;<br> }<br> public static method_2()<br> {<br> return;<br> }<br>}</p>
<p>parameter：形参<br>argument：实参 </p>
<h2 id="构造函数（构造器-constructor）"><a href="#构造函数（构造器-constructor）" class="headerlink" title="构造函数（构造器&#x2F;constructor）"></a>构造函数（构造器&#x2F;constructor）</h2><h2 id="方法的重载（Overload）"><a href="#方法的重载（Overload）" class="headerlink" title="方法的重载（Overload）"></a>方法的重载（Overload）</h2><h2 id="方法的debug"><a href="#方法的debug" class="headerlink" title="方法的debug"></a>方法的debug</h2><p>设置断点（breakpoint）<br>观察方法调用时的call stack<br>Step in&#x2F;over&#x2F;out：<br>step in步进。<br>step over直接略过跳过断点的细节操作，执行下一语句。<br>step out跳到断点的上一层级。</p>
<h2 id="方法的调用与栈"><a href="#方法的调用与栈" class="headerlink" title="方法的调用与栈"></a>方法的调用与栈</h2><p>stack frame:方法被调用的时候，在栈当中的布局。</p>
<h1 id="操作符（Operator）"><a href="#操作符（Operator）" class="headerlink" title="操作符（Operator）"></a>操作符（Operator）</h1><h2 id="概述"><a href="#概述" class="headerlink" title="概述"></a>概述</h2><p>操作符有先后顺序，层级高的先运算，相同层级的从左往右依次运算。<br>赋值和lambda表达式，是从右向左运算（赋值），例如x &#x3D; y;<br>操作符本质是函数的简记，例如3x5可以写为：Mul(3,5);<br>default操作符：获取当前类型的默认值。<br>new操作符：创造实例。 以及创造匿名类型的实例，然后用隐式类型变量引用这个实例。<br>new修饰符：在重写父类方法的时候，可以隐藏父类方法。<br>check操作符：检测程序是否溢出，若溢出则抛出异常。<br>unchecked 操作符：用于禁止溢出检查。它告诉编译器在执行某些可能导致溢出的数学运算时，不要抛出 OverflowException 异常，而是允许溢出发生，并对溢出的结果进行截断或回绕。<br>try-catch:当程序执行到 try 块中的代码时，如果发生了异常（错误），程序会立即跳转到 catch 块，而不会继续执行后续的代码。<br>sizeof操作符：获取结构体数据类型实例，在内存当中的字节数。<br>~操作符：在二进制上进行按位取反。对最小值用负号（-）来取反，得不到最大值，二进制编码取反原理造成的原因。</p>
<h1 id="字段、属性、常量、索引器"><a href="#字段、属性、常量、索引器" class="headerlink" title="字段、属性、常量、索引器"></a>字段、属性、常量、索引器</h1><h2 id="字段（field）"><a href="#字段（field）" class="headerlink" title="字段（field）"></a>字段（field）</h2><p>表示与对象（类型）关联的变量，是类型的成员，旧称成员变量 。<br>实例字段：与对象相关联。在对象创建时才被初始化。<br>静态字段：与类型相关联，用static修饰。在类型被加载时才被初始化。</p>
<h2 id="属性（property）"><a href="#属性（property）" class="headerlink" title="属性（property）"></a>属性（property）</h2><p>是用于访问对象或者类型的特征的成员，特征反映了状态。<br>属性是由字段发展而来，是字段的一种拓展。<br>字段：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//旧的写法</span></span><br><span class="line"><span class="keyword">public</span> <span class="built_in">int</span> Age;</span><br><span class="line"><span class="comment">//get/set的写法</span></span><br><span class="line"><span class="keyword">private</span> <span class="built_in">int</span> age;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">GetAge</span>()<span class="comment">//获取字段的值</span></span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="keyword">this</span>.age;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">SetAge</span>(<span class="params"><span class="built_in">int</span> <span class="keyword">value</span></span>)<span class="comment">//设置字段的值</span></span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">if</span>(<span class="keyword">value</span>&gt;=<span class="number">0</span>&amp;&amp;<span class="keyword">value</span>&lt;=<span class="number">120</span>)</span><br><span class="line"> &#123;</span><br><span class="line">  <span class="keyword">this</span>.age=<span class="keyword">value</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> ...</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>
<p>属性现在的声明方法：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">private</span> <span class="built_in">int</span> age;</span><br><span class="line"><span class="keyword">private</span> <span class="built_in">int</span> Age</span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">get</span></span><br><span class="line"> &#123;</span><br><span class="line"> <span class="keyword">return</span> <span class="keyword">this</span>.age;&#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">set</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="keyword">if</span>(<span class="keyword">value</span>&gt;=<span class="number">0</span>&amp;&amp;<span class="keyword">value</span>&lt;=<span class="number">120</span>)</span><br><span class="line">  &#123;</span><br><span class="line">   <span class="keyword">this</span>.age=<span class="keyword">value</span>;</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>value在get&#x2F;set的语法中，是专属的关键字（上下文关键字），表示传进来的数值。<br>属性，也是一种语法糖，是编译器简化了编译过程。<br>prop&#x2F;propfull：属性声明的简写</p>
<h2 id="索引器"><a href="#索引器" class="headerlink" title="索引器"></a>索引器</h2><p>…</p>
<h2 id="常量（constant）"><a href="#常量（constant）" class="headerlink" title="常量（constant）"></a>常量（constant）</h2><p>关键字：const;<br>隶属于，类型而非对象。<br>局部常量，成员常量</p>
<h2 id="各种“只读”"><a href="#各种“只读”" class="headerlink" title="各种“只读”"></a>各种“只读”</h2><p>常量，只读字段，只读属性，静态只读字段。</p>
<h1 id="参数"><a href="#参数" class="headerlink" title="参数"></a>参数</h1><h2 id="值参数"><a href="#值参数" class="headerlink" title="值参数"></a>值参数</h2><p>不带任何修饰符的参数。</p>
<h2 id="引用参数"><a href="#引用参数" class="headerlink" title="引用参数"></a>引用参数</h2><p>用ref修饰符声明的形参。不创建新的储存位置，引用参数所表示的储存位置是调用中作为实参给出变量所表示的储存位置。<br>变量在座位引用参数之前，必须明确赋值。<br>引用修饰符作用，强调该方法会改变传入的变量的值。<br>（难理解，比较绕）</p>
<h2 id="输出形参"><a href="#输出形参" class="headerlink" title="输出形参"></a>输出形参</h2><p>用out修饰符声明的形参，输出形参不创建新的储存位置，表示的储存位置恰是该方法调用中作为实参给出的那个变量所表示的储存位置。<br>会产生除return之外的额外返回值。<br>PS：params关键字<br>int res &#x3D; Cal(1,2,3);<br>static int Cal(params int[] intArray)<br>{<br> …<br>}<br>params会自动声明，只需要输入数值即可。</p>
<h2 id="具名调用"><a href="#具名调用" class="headerlink" title="具名调用"></a>具名调用</h2><p>Printinfo(age:34,name:”Tim”);<br>Static void Printinfo(string name,int age)<br>{<br> …<br>}</p>
<h2 id="可选参数"><a href="#可选参数" class="headerlink" title="可选参数"></a>可选参数</h2><p>Printinfo();<br>Static void Printinfo(string name&#x3D;”Tim”,int age&#x3D;34)</p>
<h2 id="扩展方法（This"><a href="#扩展方法（This" class="headerlink" title="扩展方法（This)"></a>扩展方法（This)</h2><p>扩展方法必须是public static<br>方法中的第一个参数必须被this修饰<br>必须由静态类（static）进行收纳</p>
<p>x作为Round方法的第一个参数（double intput），因此仅需要输入第二个参数即可。<br>在double intput前加上this之后，所有double类型的值均可以使用这个方法。<br><code>double x =3.14159; double y =x.Round(4); static class DoubleExtension &#123;  public static double Round(this double input,int digits) &#123;  ... &#125; &#125;</code></p>
<p>LINQ方法：</p>
<h2 id="委托（delegate）"><a href="#委托（delegate）" class="headerlink" title="委托（delegate）"></a>委托（delegate）</h2><p>是（C&#x2F;C++）函数指针的“升级版”、<br>变量（数据）是以某个地址为起点的一段内存中所存储的值；<br>变量，是寻找数据的地址。<br>函数（算法）是以某个地址为起点的一段内存中所存储的一组机器语言指令；<br>函数，是寻找算法的地址。<br>直接调用与间接调用：<br>直接调用：通过函数名来调用函数，CPU通过函数名获取函数所在地址。<br>间接调用：通过函数指针调用函数，CPU通过读取函数指针存储的值，获取函数所在地址。</p>
<h3 id="Action委托实例"><a href="#Action委托实例" class="headerlink" title="Action委托实例"></a>Action委托实例</h3><p>Action委托：无返回值的委托类型。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span>]</span></span></span><br><span class="line"><span class="params"><span class="function">&#123;</span></span></span><br><span class="line"><span class="params"><span class="function"> Calculator calculator = <span class="keyword">new</span> Calculator(</span>)</span>;</span><br><span class="line"> Action action = <span class="keyword">new</span> Action(calculator.Report);</span><br><span class="line"> <span class="comment">//calculator.Report不需要加()，因为只是需要方法名的地址，而不是需要调用它。</span></span><br><span class="line"> calculator.Report();</span><br><span class="line"> action.Invoke();</span><br><span class="line"> action();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Calculator</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Report</span>()</span></span><br><span class="line"> &#123;</span><br><span class="line">  Console. WriteLine(<span class="string">&quot;I have 3 methods.&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="Func委托实例"><a href="#Func委托实例" class="headerlink" title="Func委托实例"></a>Func委托实例</h3><p>有返回值的委托</p>
<h3 id="委托的声明"><a href="#委托的声明" class="headerlink" title="委托的声明"></a>委托的声明</h3><p>委托是一种类（Class），但是声明方式和一般的类不同。<br>注意声明委托的位置：命名空间下，类&#x2F;主函数之外，避免写错地方形成嵌套类型</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">DelegateExample</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="built_in">delegate</span> <span class="built_in">double</span> <span class="title">Calc</span>(<span class="params"><span class="built_in">double</span> x, <span class="built_in">double</span> y</span>)</span>;</span><br><span class="line"> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span></span><br><span class="line"> &#123;</span><br><span class="line">   Calculator calculator = <span class="keyword">new</span> Calculator();</span><br><span class="line">   Calc calc1 = <span class="keyword">new</span> Calc(calculator.Add); </span><br><span class="line">   Calc calc2 = <span class="keyword">new</span> Calc(calculator.Sub);</span><br><span class="line">   Calc calc3 = <span class="keyword">new</span> Calc(calculator. Mul);</span><br><span class="line">   Calc calc4 = <span class="keyword">new</span> Calc(calculator.Div);</span><br><span class="line">   <span class="built_in">double</span> a = <span class="number">100</span>;</span><br><span class="line">   <span class="built_in">double</span> b = <span class="number">200</span>;</span><br><span class="line">   <span class="built_in">double</span> c = <span class="number">0</span>;</span><br><span class="line">   c = calc1.Invokola, b);</span><br><span class="line">   Console. WriteLine[c];</span><br><span class="line">   c = calc2.Invoke(a, b);</span><br><span class="line">   Console. WriteLine(c);</span><br><span class="line">   c = calc3.Invoke(a, b);</span><br><span class="line">   Console. WriteLine(c);</span><br><span class="line">   c = calc4.Invoke(a, b);</span><br><span class="line">   Console. WriteLine(c);</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">class</span> <span class="title">Calculator</span></span><br><span class="line"> &#123;</span><br><span class="line">  ...</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="委托的使用"><a href="#委托的使用" class="headerlink" title="委托的使用"></a>委托的使用</h3><p>1.把方法当作参数传给另外一个方法。<br>模板方法，“借用”指定的外部方法，来产生结果<br>相当于“填空题”，委托也有返回值，除了委托部分不确定，其他部分都是确定的。<br>2.回调（callback）方法，调用指定的外部方法<br>相当于“流水线”，委托不需要有返回值。你可以从许多方法中选择自己需要的委托方法。</p>
<h3 id="委托使用的案例"><a href="#委托使用的案例" class="headerlink" title="委托使用的案例"></a>委托使用的案例</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">DelegateExample</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line"> <span class="title">static</span> <span class="title">void</span> <span class="title">Main</span>(<span class="title">string</span>[] <span class="title">args</span>]</span><br><span class="line"> &#123;</span><br><span class="line">   ProductFactory productFactory = <span class="keyword">new</span> ProductFactory[);</span><br><span class="line">   WrapFactory wrapFactory = <span class="keyword">new</span> WrapFactory[];</span><br><span class="line">   Func&lt;Product&gt; func1 = <span class="keyword">new</span> Func&lt;Product&gt;(productFactory.MakePizza);</span><br><span class="line">   Func&lt;Product&gt; func2 = <span class="keyword">new</span> Func&lt;Product&gt;(productFactory.MakeToyCar);</span><br><span class="line">   Logger logger =<span class="keyword">new</span> Logger();</span><br><span class="line">   Action&lt;Product&gt; log = <span class="keyword">new</span> Action&lt;Product&gt;(logger.Log);</span><br><span class="line">   Box box1 = wrapFactory.WrapProduct(func1,log);</span><br><span class="line">   Box box2 = wrapFactory.WrapProduct(func2,log);</span><br><span class="line">   Console. WriteLine(box1.Product.Name];</span><br><span class="line">   Console. WriteLine(box2.Product.Name];</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">class</span> <span class="title">Product</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">string</span> Name&#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">class</span> <span class="title">Box</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="keyword">public</span> Product Product&#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">class</span> <span class="title">WrapFactory</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> Box <span class="title">WrapProduct</span>(<span class="params">Func&lt;Product&gt; getProduct</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">   Box box=<span class="keyword">new</span> Box():</span><br><span class="line">   Product product=getProduct.Invoke();</span><br><span class="line">   box.Product=product;</span><br><span class="line">   <span class="keyword">return</span> box;</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title">ProductFactory</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> Product <span class="title">MakePizza</span>()</span></span><br><span class="line"> &#123;</span><br><span class="line">  Product product=<span class="keyword">new</span> Product[];</span><br><span class="line">  product.Name= <span class="string">&quot;Pizza&quot;</span>:</span><br><span class="line">  <span class="keyword">return</span> product;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> Product <span class="title">MakeToyCar</span>()</span></span><br><span class="line"> &#123;</span><br><span class="line">  Product product=<span class="keyword">new</span> Product[];</span><br><span class="line">  product.Name = <span class="string">&quot;Toy Car&quot;</span>;</span><br><span class="line">  <span class="keyword">return</span> product;</span><br><span class="line"> &#125;</span><br><span class="line">&#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="回调Callback方法案例"><a href="#回调Callback方法案例" class="headerlink" title="回调Callback方法案例"></a>回调Callback方法案例</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">DelegateExample</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line"> <span class="title">static</span> <span class="title">void</span> <span class="title">Main</span>(<span class="title">string</span>[] <span class="title">args</span>]</span><br><span class="line"> &#123;</span><br><span class="line">  ProductFactory productFactory = <span class="keyword">new</span> ProductFactory[);</span><br><span class="line">  WrapFactory wrapFactory = <span class="keyword">new</span> WrapFactory[];</span><br><span class="line">  Func&lt;Product&gt; func1 = <span class="keyword">new</span> Func&lt;Product&gt;(productFactory.MalkePizza)</span><br><span class="line">  Func&lt;Product&gt; func2 = <span class="keyword">new</span> Func&lt;Product&gt;(productFactory.MaakeToyCar)</span><br><span class="line">  Box box1 = wrapFactory.WrapProduct(func1);</span><br><span class="line">  Box box2 = wrapFactory.WrapProduct(func2);</span><br><span class="line">  Console. WriteLine(box1.Product.Name];</span><br><span class="line">  Console. WriteLine(box2.Product.Name];</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">class</span> <span class="title">Logger</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Log</span>(<span class="params">Product product</span>)</span></span><br><span class="line">  &#123;</span><br><span class="line">   Console.WriteLine(<span class="string">&quot;Product&#123;0&#125;...&quot;</span>)</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">class</span> <span class="title">Product</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">string</span> Name&#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">  <span class="keyword">public</span> <span class="built_in">string</span> Price&#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">class</span> <span class="title">Box</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="keyword">public</span> Product Product&#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">class</span> <span class="title">WrapFactory</span></span><br><span class="line"> &#123;</span><br><span class="line"> </span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> Box <span class="title">WrapProduct</span>(<span class="params">Func&lt;Product&gt;getProduct,Action&lt;Product&gt;logCallback</span>)</span></span><br><span class="line"> &#123;</span><br><span class="line">  Box box=newBox():</span><br><span class="line">  Product product=getProduct.Invoke();</span><br><span class="line">  <span class="keyword">if</span>(product.Price&gt;=<span class="number">50</span>)</span><br><span class="line">  &#123;</span><br><span class="line">   logCallback(product);</span><br><span class="line">  &#125;</span><br><span class="line">  box.Product=product;</span><br><span class="line">  <span class="keyword">return</span> box;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">ProductFactory</span></span><br><span class="line"> <span class="title">public</span> <span class="title">Product</span> <span class="title">MakePizza</span>()</span><br><span class="line"> &#123;</span><br><span class="line">  Product product=<span class="keyword">new</span> Product[];</span><br><span class="line">  product.Name= <span class="string">&quot;Pizza&quot;</span>;</span><br><span class="line">  product.Price=<span class="number">12</span>;</span><br><span class="line">  <span class="keyword">return</span> product;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> Product <span class="title">MakeToyCar</span>()</span></span><br><span class="line"> &#123;</span><br><span class="line">  Product product=<span class="keyword">new</span> Product[];</span><br><span class="line">  product.Name = <span class="string">&quot;Toy Car&quot;</span>;</span><br><span class="line">  product.Price=<span class="number">100</span>; </span><br><span class="line">  <span class="keyword">return</span> product;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="委托使用的注意点"><a href="#委托使用的注意点" class="headerlink" title="委托使用的注意点"></a>委托使用的注意点</h3><p>委托是一种方法级别的耦合，现实工作中要慎之又慎；<br>委托使用不当，会使可读性下降、debug难度增加；<br>把委托回调、异步调用、多线程纠缠在一起，会将代码变得难以阅读和维护；<br>委托使用不当可能造成内存泄漏和程序性能下降。（被占用的内存无法被释放）</p>
<h3 id="多播委托（multicast）"><a href="#多播委托（multicast）" class="headerlink" title="多播委托（multicast）"></a>多播委托（multicast）</h3><p>一个委托内部，封装了不止一个方法。 </p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span>]</span></span></span><br><span class="line"><span class="params"><span class="function"> &#123;</span></span></span><br><span class="line"><span class="params"><span class="function">  Student stu1 = <span class="keyword">new</span> Student(</span>)</span> &#123;ID = <span class="number">1</span>, PenColor = ConsoleColorYellow&#125;</span><br><span class="line">  Student stu2 = <span class="keyword">new</span> Student() &#123;ID = <span class="number">2</span>, PenColor = ConsoleColorGreen&#125;</span><br><span class="line">  Student stu3 = <span class="keyword">new</span> Student() &#123;ID = <span class="number">3</span>, PenColor = ConsoleColor.Red &#125; </span><br><span class="line">  Action action1 = <span class="keyword">new</span> Action(stu1.DoHomework);</span><br><span class="line">  Action action2 = <span class="keyword">new</span> Action(stu2.DoHomework);</span><br><span class="line">  Action action3 = <span class="keyword">new</span> Action(stu3.DoHomework];</span><br><span class="line">  action1 += action2;</span><br><span class="line">  action1 += action3;</span><br><span class="line">  action1.Invoke();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="隐式异步调用"><a href="#隐式异步调用" class="headerlink" title="隐式异步调用"></a>隐式异步调用</h3><ul>
<li>同步与异步<br>同步：你做完了，我在你做的基础之上接着做。<br>异步：我们俩同时做。（同步进行）</li>
<li>同步调用与异步调用<br>每个程序都是一个进程（process）<br>每个进程可以有多个线程（Thread）<br>同步调用是在同一线程内，异步调用底层机理是多线程</li>
<li>隐式多线程与显示多线程<br>直接同步调用：直接通过方法名调用；<br>间接同步调用：使用委托进行；<br>隐式异步调用：使用委托的异步调用方法；<br>例子：<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line"><span class="title">static</span> <span class="title">void</span> <span class="title">Main</span>[<span class="title">string</span>[] <span class="title">args</span>]</span><br><span class="line"><span class="title">Student</span> <span class="title">stu1</span> = <span class="keyword">new</span> Student() &#123;ID = <span class="number">1</span>, PenColor = ConsoleCColor. Yellow</span><br><span class="line">Student stu2 = <span class="keyword">new</span> Student() &#123;ID = <span class="number">2</span>, PenColor = ConsoleCColor.Green</span><br><span class="line">Student stu3 = <span class="keyword">new</span> Student() &#123;ID = <span class="number">3</span>, PenColor = ConsoleCColor.Red</span><br><span class="line">Action action1 = <span class="keyword">new</span> Action(stu1.DoHomework];</span><br><span class="line">Action action2=<span class="keyword">new</span> Action(stu2.DoHomework);</span><br><span class="line">Action action3 = <span class="keyword">new</span> Action[stu3.DoHomework];</span><br><span class="line">action1.BeginInvoke(<span class="literal">null</span>,<span class="literal">null</span>)</span><br><span class="line"><span class="comment">//生成一个分支线程。在分支线程里面调用方法。参数1：调用完之后的后续操作。</span></span><br><span class="line"><span class="comment">//.NET库不支持begininvoke，改用await Task.Run(Action1);</span></span><br><span class="line"><span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++)</span><br><span class="line">Console.Foreground Color = ConsoleColor.Cyan;</span><br><span class="line">Console.WriteLine[<span class="string">&quot;Main thread &#123;0&#125;.&quot;</span>. i];</span><br><span class="line">Thread.Sleep(<span class="number">1000</span>);</span><br><span class="line"><span class="keyword">class</span> <span class="title">Student</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="comment">//...</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>显式异步调用：使用Thread或者Task；</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">Student stu1 = <span class="keyword">new</span> Student() &#123;ID = <span class="number">1</span>, PenColor = ConsoleCColor. Yellow</span><br><span class="line"></span><br><span class="line">Student stu2 = <span class="keyword">new</span> Student() &#123;ID = <span class="number">2</span>, PenColor = ConsoleCColor.Green</span><br><span class="line"></span><br><span class="line">Student stu3 = <span class="keyword">new</span> Student() &#123;ID = <span class="number">3</span>, PenColor = ConsoleColor.Red</span><br><span class="line"></span><br><span class="line">Thread thread1 = <span class="keyword">new</span> Thread[<span class="keyword">new</span> ThreadStart(stu1.DoHomework)];</span><br><span class="line"></span><br><span class="line">Thread thread2 = <span class="keyword">new</span> Thread[<span class="keyword">new</span> ThreadStart(stu2.DoHomework)]</span><br><span class="line"></span><br><span class="line">Thread thread3 = <span class="keyword">new</span> Thread[<span class="keyword">new</span> ThreadStart(stu3.DoHomework)]</span><br><span class="line"></span><br><span class="line">thread1.Start();</span><br><span class="line"></span><br><span class="line">thread2.Start();</span><br><span class="line"></span><br><span class="line">thread3.Start();</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Student</span></span><br><span class="line"></span><br><span class="line">&#123;</span><br><span class="line"></span><br><span class="line"> <span class="comment">//...</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">Student stu1 = <span class="keyword">new</span> Student() &#123;ID = <span class="number">1</span>, PenColor = ConsoleColor. Yellow</span><br><span class="line"></span><br><span class="line">Student stu2 = <span class="keyword">new</span> Student() &#123;ID = <span class="number">2</span>, PenColor = ConsoleColorGreen&#125;</span><br><span class="line"></span><br><span class="line">Student stu3 = <span class="keyword">new</span> Student() &#123;ID = <span class="number">3</span>, PenColor = ConsoleColor.FRed</span><br><span class="line"></span><br><span class="line">Task task1 = <span class="keyword">new</span> Task[<span class="keyword">new</span> Action[stu1.DoHomework]];</span><br><span class="line"></span><br><span class="line">Task task2 = <span class="keyword">new</span> Task[<span class="keyword">new</span> Action[stu2.DoHomework]];</span><br><span class="line"></span><br><span class="line">Task task3 = <span class="keyword">new</span> Task(<span class="keyword">new</span> Action(stu3.DoHomework));</span><br><span class="line"></span><br><span class="line">task1.Start();</span><br><span class="line"></span><br><span class="line">task2.Start():</span><br><span class="line"></span><br><span class="line">task3.Start[]:</span><br></pre></td></tr></table></figure>

<ul>
<li>适当的使用接口（interface）取代对委托的使用</li>
<li>接口可以取代委托的作用。</li>
</ul>
<h1 id="事件（Event）"><a href="#事件（Event）" class="headerlink" title="事件（Event）"></a>事件（Event）</h1><p>事件是，使对象或类具备通知能力的成员（to provide notification）。<br>事件主要用于，对象或类之间的动作协调与信息传递（消息推送）。</p>
<p>事件参数（Event Args）<br>响应事件 </p>
<h2 id="事件模型的五个组成部分"><a href="#事件模型的五个组成部分" class="headerlink" title="事件模型的五个组成部分"></a>事件模型的五个组成部分</h2><ul>
<li>事件拥有者（event source ， 对象）</li>
<li>事件成员（event ，成员）</li>
<li>时间的响应者（event subscriber ， 对象）</li>
<li>事件处理器（event handler ， 成员）</li>
<li>事件订阅——把事件处理器与事件进行关联，本质是一种以委托类型为基础的“约定”。</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Timers;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">EventStudy</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Timer timer = <span class="keyword">new</span> Timer();</span><br><span class="line">            timer.Interval = <span class="number">1000</span>;</span><br><span class="line">            Boy boy = <span class="keyword">new</span> Boy();</span><br><span class="line">            timer.Elapsed += boy.Action;</span><br><span class="line">            timer.Start();</span><br><span class="line">            Console.ReadLine();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Boy</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">internal</span> <span class="keyword">void</span> <span class="title">Action</span>(<span class="params"><span class="built_in">object</span> sender, ElapsedEventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;Jump!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Timers;</span><br><span class="line"><span class="keyword">using</span> System.Windows.Forms;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">EventStudy</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Form form =<span class="keyword">new</span> Form();</span><br><span class="line">            Controller controller=<span class="keyword">new</span> Controller(form);</span><br><span class="line">            form.ShowDialog();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Controller</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> Form form;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">Controller</span>(<span class="params">Form form</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.form = form;</span><br><span class="line">            <span class="keyword">this</span>.form.Click += <span class="keyword">this</span>.FormClick;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">FormClick</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.form.Text = DateTime.Now.ToString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Timers;</span><br><span class="line"><span class="keyword">using</span> System.Windows.Forms;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">EventStudy</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            MyForm form = <span class="keyword">new</span> MyForm();</span><br><span class="line">            form.Click += form.FormClick;</span><br><span class="line">            form.ShowDialog();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">MyForm</span> : <span class="title">Form</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">internal</span> <span class="keyword">void</span> <span class="title">FormClick</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.Text = DateTime.Now.ToString();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>最常用用法：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Timers;</span><br><span class="line"><span class="keyword">using</span> System.Windows.Forms;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">EventStudy</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            MyForm form = <span class="keyword">new</span> MyForm();</span><br><span class="line">            form.ShowDialog();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">MyForm</span> : <span class="title">Form</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> TextBox textBox;</span><br><span class="line">        <span class="keyword">private</span> Button button;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="title">MyForm</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.textBox = <span class="keyword">new</span> TextBox();</span><br><span class="line">            <span class="keyword">this</span>.button = <span class="keyword">new</span> Button();</span><br><span class="line">            <span class="keyword">this</span>.Controls.Add(textBox);</span><br><span class="line">            <span class="keyword">this</span>.Controls.Add(button);</span><br><span class="line">            <span class="keyword">this</span>.button.Click += <span class="keyword">this</span>.ButtonClicked;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">ButtonClicked</span>(<span class="params"><span class="built_in">object</span> sender, EventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">this</span>.textBox.Text = <span class="string">&quot;Hello ,World!!!!!!!!&quot;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="事件的声明"><a href="#事件的声明" class="headerlink" title="事件的声明"></a>事件的声明</h2><p>完整声明</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Timers;</span><br><span class="line"><span class="keyword">using</span> System.Windows.Forms;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">EventStudy</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Customer customer = <span class="keyword">new</span> Customer();</span><br><span class="line">            Waiter waiter = <span class="keyword">new</span> Waiter();</span><br><span class="line">            customer.Order += waiter.Action;</span><br><span class="line">            Console.ReadLine();</span><br><span class="line">            customer.Think();</span><br><span class="line">            customer.Paythebill();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">OrderEventArgs</span> : <span class="title">EventArgs</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> DishName &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">string</span> Size &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">delegate</span> <span class="keyword">void</span> <span class="title">OrderEventHandler</span>(<span class="params">Customer customer, OrderEventArgs e</span>)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Customer</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">private</span> OrderEventHandler orderEventHandler;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">event</span> OrderEventHandler Order</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">add</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">this</span>.orderEventHandler += <span class="keyword">value</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">remove</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">this</span>.orderEventHandler -= <span class="keyword">value</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">double</span> Bill &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Paythebill</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;I will pay $&#123;0&#125;&quot;</span>, <span class="keyword">this</span>.Bill);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Think</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            OrderEventArgs e = <span class="keyword">new</span> OrderEventArgs();</span><br><span class="line">            e.DishName = <span class="string">&quot;baga&quot;</span>;</span><br><span class="line">            e.Size = <span class="string">&quot;large&quot;</span>;</span><br><span class="line">            <span class="keyword">this</span>.orderEventHandler.Invoke(<span class="keyword">this</span>, e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Waiter</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Action</span>(<span class="params">Customer customer, OrderEventArgs e</span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine(<span class="string">&quot;I will serve you the dish : &#123;0&#125;&quot;</span>, e.DishName);</span><br><span class="line">            <span class="built_in">double</span> price = <span class="number">10</span>;</span><br><span class="line">            <span class="keyword">switch</span> (e.Size)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;small&quot;</span>:</span><br><span class="line">                    price = price * <span class="number">0.5</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;large&quot;</span>:</span><br><span class="line">                    price = price * <span class="number">1.5</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="literal">default</span>:</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            customer.Bill = price;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>简略声明（Field-like）<br>语法糖。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">event</span> OrderEventHandler Order;</span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Think</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    OrderEventArgs e = <span class="keyword">new</span> OrderEventArgs();</span><br><span class="line">    e.DishName = <span class="string">&quot;baga&quot;</span>;</span><br><span class="line">    e.Size = <span class="string">&quot;large&quot;</span>;</span><br><span class="line">    <span class="keyword">this</span>.Order.Invoke(<span class="keyword">this</span>, e);</span><br><span class="line">    <span class="comment">//简略后，用事件代替为之前的字段。</span></span><br><span class="line">    <span class="comment">//而在完整版的代码中，事件只能用来+=（订阅）运算。</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>事件，让程序更加有逻辑，对象之间的关系更清晰。<br>委托是方法与方法之间的强关联，事件是对象与对象之间。而委托可能造成，不同对象，对同一个方法进行滥用。<br>事件，只能访问事件的订阅操作，而想访问事件的其他层面则不允许。而委托，可以设定传入委托的具体参数和返回值。<br>事件的本质，是委托字段的包装器，对其进行封装（encapsulation），事件对外界隐藏了委托实例的大部分功能，而只能对其进行订阅。<br>protected,dynamic,partial，virtual</p>
<h1 id="类（class）"><a href="#类（class）" class="headerlink" title="类（class）"></a>类（class）</h1><p>构造函数与析构函数<br>析构函数：<code>~Student()&#123;...&#125;</code></p>
<h2 id="类的访问级别修饰符"><a href="#类的访问级别修饰符" class="headerlink" title="类的访问级别修饰符"></a>类的访问级别修饰符</h2><p>也就是，当其他项目（Aseembly）想要访问当前项目时，该类是否能被引用。<br>public：外部可以引用。<br>internal：仅在该项目内部有效。</p>
<h2 id="类的继承"><a href="#类的继承" class="headerlink" title="类的继承"></a>类的继承</h2><p>base class （基类）与derived class（派生类）<br>父类与子类<br>一个子类的实例，也是父类的一个实例。（例如，一个类的实例，是这个类的实例，也是object类的实例）<br>sealed：将该类进行封闭，不能再进行继承。<br>C#中一个类只支持一个基类，但是可以支持多个基接口。<br>public与internal修饰的类，需要注意访问级别的层级问题，子类访问级别不能高于父类。<br>在构造基类与派生类时，派生类会对基类的方法等进行改写和重构，如果再想通过该派生类去访问该派生类改写过的基类的方法等，是不行的（已被改写）。<br>父类的实例构造器，不能被子类继承。</p>
<h2 id="类成员的访问"><a href="#类成员的访问" class="headerlink" title="类成员的访问"></a>类成员的访问</h2><p>protected：将类成员的访问级别，限制在继承链上，protected 的类&#x2F;方法，其子类可以对其进行访问。并且是跨程序集的。可以跟internal修饰符进行组合。</p>
<h2 id="重写与多态（polymorphism）"><a href="#重写与多态（polymorphism）" class="headerlink" title="重写与多态（polymorphism）"></a>重写与多态（polymorphism）</h2><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Vehicle</span> </span><br><span class="line">&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Run</span>()</span></span><br><span class="line"><span class="function"> Console.<span class="title">WriteLine</span>(<span class="params"><span class="string">&quot;I&#x27;m running!&quot;</span></span>)</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Car</span>: <span class="title">Vehicle</span> </span><br><span class="line">&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Run</span>()</span> </span><br><span class="line"> &#123;</span><br><span class="line">  Console.WriteLine(<span class="string">&quot;Car is running!&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>如果不加virtual与override，则是子类对父类方法的隐藏。<br>在C#编程中，可以通过父类来声明一个子类的实例，这样做的用意是实现多态，也就是，在父类的引用中存储任何一个子类的对象，从而可以调用不同子类的实现。<strong>（父类的方法或者属性，引用继承链上实例化的子类所带有的最新重写版本）</strong><br>通过父类声明子类实例可以让代码更加通用，尤其是在处理大量继承体系时。<br>在使用父类声明子类的实例时，最终得到的是 子类的实例，尽管变量的类型是父类。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">MakeAnimalSound</span>(<span class="params">Animal animal</span>)</span></span><br><span class="line">&#123;</span><br><span class="line">    animal.MakeSound();  <span class="comment">// 不管是 Dog 还是 Cat，都会调用各自的 MakeSound 方法</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">&#123;</span><br><span class="line">    Animal dog = <span class="keyword">new</span> Dog();</span><br><span class="line">    Animal cat = <span class="keyword">new</span> Cat();</span><br><span class="line"></span><br><span class="line">    MakeAnimalSound(dog);  <span class="comment">// 输出: Bark</span></span><br><span class="line">    MakeAnimalSound(cat);  <span class="comment">// 输出: Meow</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Animal</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>; &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">virtual</span> <span class="keyword">void</span> <span class="title">Speak</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Animal speaks&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Dog</span> : <span class="title">Animal</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">WagTail</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Dog is wagging its tail&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Speak</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">&quot;Dog barks&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        Animal animal = <span class="keyword">new</span> Dog(); <span class="comment">// 父类类型的变量指向子类实例</span></span><br><span class="line">        animal.Name = <span class="string">&quot;Buddy&quot;</span>;</span><br><span class="line">        </span><br><span class="line">        animal.Speak();  <span class="comment">// 输出: Dog barks</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// animal.WagTail();  // 错误，Animal 类中没有 WagTail 方法</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>属性也可以被重写。</p>
<h1 id="接口、抽象类、SOLID、单元测试和反射"><a href="#接口、抽象类、SOLID、单元测试和反射" class="headerlink" title="接口、抽象类、SOLID、单元测试和反射"></a>接口、抽象类、SOLID、单元测试和反射</h1><h2 id="接口与抽象类"><a href="#接口与抽象类" class="headerlink" title="接口与抽象类"></a>接口与抽象类</h2><p>算法\设计原则<br>具体类 → 抽象类 → 接口：越来越抽象，内部实现的东西越来越少。<br>抽象类是未完全实现逻辑的类,（有被实现的部分也就是非abstract部分，也有部分abstract的）</p>
<h3 id="抽象类与开放关闭（开闭）原则"><a href="#抽象类与开放关闭（开闭）原则" class="headerlink" title="抽象类与开放关闭（开闭）原则"></a>抽象类与开放关闭（开闭）原则</h3><p><strong>抽象类</strong>不允许被实例化，但是可以作为基类。可以通过子类实例引用具体的方法。<br><strong>开闭原则</strong>：没有特别情况（修BUG和增添新功能），尽可能不去修改已经写好的代码。也就是：我们应该封装那些不变的、稳定的、固定的和确定的成员，把那些不确定的、有可能改变的成员声明为抽象成员，并且留给子类去实现。</p>
<h3 id="接口（Interface）与单元测试"><a href="#接口（Interface）与单元测试" class="headerlink" title="接口（Interface）与单元测试"></a>接口（Interface）与单元测试</h3><ul>
<li>接口是完全未实现逻辑的“类”，成员全部为public.</li>
<li>接口为解耦而生，方便单元测试，高内聚，低耦合。</li>
<li>接口是一个协约（contract）（有分工必有协作，有协作必有协约）</li>
<li>接口不能被实例化，只能用来声明变量、引用具体类（concrete class）的实例。<br>举例：<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//接口-最抽象的类（所有方法等都是abstract）</span></span><br><span class="line"><span class="keyword">interface</span> <span class="title">IVehicle</span> </span><br><span class="line">&#123;</span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">Stop</span>()</span>;</span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">Fill</span>()</span>;</span><br><span class="line"> <span class="function"><span class="keyword">void</span> <span class="title">Run</span>()</span></span><br><span class="line"><span class="function">&#125;</span></span><br><span class="line"><span class="function"><span class="comment">//基类</span></span></span><br><span class="line"><span class="function"><span class="keyword">abstract</span> <span class="keyword">class</span> Vehicle : IVehicle</span> </span><br><span class="line">&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Stop</span>()</span></span><br><span class="line"> &#123;</span><br><span class="line">  Console.WriteLine(<span class="string">&#x27;Stopped!&#x27;</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Fill</span>()</span> </span><br><span class="line"> &#123;</span><br><span class="line">  Console.WriteLine(<span class="string">&quot;Pay and fill...&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">abstract</span> <span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Run</span>()</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//实现类-两个</span></span><br><span class="line"><span class="keyword">class</span> <span class="title">Car</span> : <span class="title">IVehicle</span> </span><br><span class="line">&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Run</span>()</span> </span><br><span class="line"> &#123;</span><br><span class="line">  Console.WriteLine(<span class="string">&quot;Car is running...&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Truck</span> : <span class="title">IVehicle</span> </span><br><span class="line">&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">Run</span>()</span> </span><br><span class="line"> &#123;</span><br><span class="line">  Console.WriteLine(<span class="string">&quot;Truck is running&quot;</span>);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
接口在工作中的一般使用方法</li>
</ul>
<p>方法\类之间的依赖或耦合</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[<span class="keyword">args</span>] </span></span></span><br><span class="line"><span class="params"><span class="function"> &#123;</span></span></span><br><span class="line"><span class="params"><span class="function">  <span class="keyword">var</span> engine = <span class="keyword">new</span> Engine(</span>)</span>;</span><br><span class="line">  <span class="keyword">var</span> car = <span class="keyword">new</span> Car(engine);</span><br><span class="line">  car.Run(<span class="number">3</span>);</span><br><span class="line">  Console.WriteLine(car.Speed);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//Engine与Car类有紧耦合，Car类对Engine类有强依赖</span></span><br><span class="line"><span class="keyword">class</span> <span class="title">Engine</span> </span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="built_in">int</span> RPM &#123;<span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>;&#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> Work[<span class="built_in">int</span> gas] &#123;</span><br><span class="line"> <span class="keyword">this</span>.RPM = <span class="number">1000</span> * gas;</span><br><span class="line"> <span class="comment">//this.RPM = 0;</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Car</span> </span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">private</span> Engine engine;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="title">Car</span>(<span class="params">Engine engine</span>)</span> &#123;</span><br><span class="line">  _engine = engine;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="built_in">int</span> Speed &#123;<span class="keyword">get</span>; <span class="keyword">private</span> <span class="keyword">set</span>;&#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">void</span> Run[<span class="built_in">int</span> gas] &#123;</span><br><span class="line">  _engine.Work(gas);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">this</span>.Speed = engine.RPM / <span class="number">100</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>接口可以降低耦合度（保证给你提供的功能准确无误，可靠的）：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Program</span> &#123;</span><br><span class="line"> <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>ħ <span class="keyword">args</span></span>)</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> user = <span class="keyword">new</span> PhoneUser(<span class="keyword">new</span> EricssonPhone)<span class="comment">//只需要更改这一个地方，其他地方均不需要改动，因此耦合度低。</span></span><br><span class="line">  user.UsePhone();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">PhoneUser</span>&#123;</span><br><span class="line"> <span class="keyword">private</span> <span class="built_in">string</span> _<span class="function">phone</span></span><br><span class="line"><span class="function"> <span class="keyword">public</span> <span class="title">PhoneUser</span>(<span class="params">IPhone phone</span>)</span>&#123;</span><br><span class="line">  _phone = phone;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">UsePhone</span>()</span>&#123;</span><br><span class="line">  ...</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">interface</span> <span class="title">IPhone</span>&#123;...&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">NokiaPhone</span> : <span class="title">IPhone</span>&#123;...&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">EricssonPhone</span> : <span class="title">IPhone</span>&#123;...&#125;</span><br></pre></td></tr></table></figure>

<h4 id="依赖反转-倒置原则（Dependecy-Inversion）："><a href="#依赖反转-倒置原则（Dependecy-Inversion）：" class="headerlink" title="依赖反转&#x2F;倒置原则（Dependecy Inversion）："></a>依赖反转&#x2F;倒置原则（Dependecy Inversion）：</h4><p>之前是一个类依赖于另一个类，可以通过设计，改造为，一个类依赖于一个接口，而接口被依赖于其他类。<br>例如，司机依赖于交通工具接口，而不同种类的运输工具也依赖于交通工具接口。</p>
<h4 id="接口隔离原则（Interface-Seperation）"><a href="#接口隔离原则（Interface-Seperation）" class="headerlink" title="接口隔离原则（Interface Seperation）"></a>接口隔离原则（Interface Seperation）</h4><p>接口和类的大小也不能太小，要把握好度。<br>接口提供的功能多于功能调用者<br>调用者不能多要功能，也就是调用最小的接口即可。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Program</span> </span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">static</span> <span class="keyword">void</span> Main〔<span class="built_in">string</span>[] <span class="keyword">args</span>) &#123;</span><br><span class="line"> <span class="keyword">var</span> driver = <span class="keyword">new</span> Driver(<span class="keyword">new</span> Car()<span class="comment">//new Tank())&#125;;</span></span><br><span class="line"> driver.Drive();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Driver</span> </span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">private</span> IVehicle _vehicle;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="title">Driver</span>(<span class="params">IVehicle vehicle</span>)</span> </span><br><span class="line"> &#123;</span><br><span class="line">  _vehicle=vehicle;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Drive</span>()</span> </span><br><span class="line"> &#123;</span><br><span class="line">  _vehicle.Run();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"> <span class="keyword">interface</span> <span class="title">IVehicle</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">Run</span>()</span>;</span><br><span class="line"> &#125;</span><br><span class="line">  <span class="keyword">interface</span> <span class="title">IWeapon</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">Fire</span>()</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">class</span> <span class="title">Car</span> : <span class="title">IVhicle</span>&#123;...&#125;</span><br><span class="line"> <span class="keyword">class</span> <span class="title">Truck</span> : <span class="title">IVhicle</span>&#123;...&#125;</span><br><span class="line"></span><br><span class="line"> <span class="keyword">interface</span> <span class="title">ITank</span>:<span class="title">IVehicle</span>, <span class="title">IWeapon</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="comment">//</span></span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">class</span> <span class="title">LightTank</span> : <span class="title">ITank</span>&#123;...&#125;</span><br><span class="line"> <span class="keyword">class</span> <span class="title">Medium</span> <span class="title">Tank</span> : <span class="title">ITank</span>&#123;...&#125;</span><br><span class="line"> <span class="keyword">class</span> <span class="title">HeavyTank</span> : <span class="title">ITank</span>&#123;...&#125;</span><br></pre></td></tr></table></figure>

<h4 id="单元测试："><a href="#单元测试：" class="headerlink" title="单元测试："></a>单元测试：</h4><p>在同一个solution下添加新的test project,命名为:<strong>默认名称空间.test</strong>;<br>…</p>
<h2 id="反射、特性和依赖注入（Dependency-Injection）"><a href="#反射、特性和依赖注入（Dependency-Injection）" class="headerlink" title="反射、特性和依赖注入（Dependency Injection）"></a>反射、特性和依赖注入（Dependency Injection）</h2><h3 id="反射（Reflection）"><a href="#反射（Reflection）" class="headerlink" title="反射（Reflection）"></a>反射（Reflection）</h3><p>是一种设计模式，通过依赖注入实现</p>
<h3 id="依赖注入"><a href="#依赖注入" class="headerlink" title="依赖注入"></a>依赖注入</h3><p>将<code>Itank tank = new HeavyTank();</code>操作进行区分。<br>因为，当给程序进行升级的时候，很多时候接口后面所引用的实例具体类型需要大量更改，但是有的又不需要，因此，我们通过依赖注入，只需要将注册时候的引用实例类型更改一次即可，并且也可以和仍然需要<code>Itank tank = new HeavyTank();</code>的代码进行区分。</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"> <span class="keyword">interface</span> <span class="title">ITank</span>:<span class="title">IVehicle</span>, <span class="title">IWeapon</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="comment">//</span></span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">interface</span> <span class="title">IVehicle</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">Run</span>()</span>;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">interface</span> <span class="title">IWeapon</span></span><br><span class="line"> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">void</span> <span class="title">Fire</span>()</span>;</span><br><span class="line"> &#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">LightTank</span> : <span class="title">ITank</span>&#123;...&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Medium</span> <span class="title">Tank</span> : <span class="title">ITank</span>&#123;...&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">HeavyTank</span> : <span class="title">ITank</span>&#123;...&#125;</span><br><span class="line"> </span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span> </span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">static</span> <span class="keyword">void</span> Main〔<span class="built_in">string</span>[] <span class="keyword">args</span>] </span><br><span class="line"> &#123;</span><br><span class="line">  <span class="comment">//注册。</span></span><br><span class="line">  <span class="keyword">var</span> sc = <span class="keyword">new</span> ServiceCollection();</span><br><span class="line">  sc.AddScoped(<span class="keyword">typeof</span>(ITank), <span class="keyword">typeof</span>(Medium Tank)&#125;;</span><br><span class="line">  <span class="comment">//使用依赖注入后，只需要在这里更改ITank类引用的具体实例</span></span><br><span class="line">  <span class="keyword">var</span> sp = sc.<span class="function">BuildService <span class="title">Provider</span>()</span>;</span><br><span class="line">  <span class="comment">//以下，是进行前台运行操作。</span></span><br><span class="line">  ITank tank=sp.GetService&lt;lTank&gt;();</span><br><span class="line">  tank.Fire();</span><br><span class="line">  tank.Run();</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//-----------------------------------------</span></span><br><span class="line"><span class="keyword">class</span> <span class="title">Program</span> </span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">static</span> <span class="keyword">void</span> Main〔<span class="built_in">string</span>[] <span class="keyword">args</span>] </span><br><span class="line"> &#123;</span><br><span class="line">  <span class="comment">//注册。</span></span><br><span class="line">  <span class="keyword">var</span> sc = <span class="keyword">new</span> ServiceCollection();</span><br><span class="line">  sc.AddScoped(<span class="keyword">typeof</span>(IVehicle), <span class="keyword">typeof</span>(Medium Tank)&#125;;</span><br><span class="line">  sc.AddScoped&lt;Driver&gt;();</span><br><span class="line">  <span class="keyword">var</span> sp = sc.<span class="function">BuildService <span class="title">Provider</span>()</span>;</span><br><span class="line">  <span class="comment">//以下，是进行前台运行操作。</span></span><br><span class="line">  <span class="keyword">var</span> driver=sp.GetService&lt;Driver&gt;();</span><br><span class="line">  <span class="comment">//当我们创建driver实例的时候，不再需要在构造函数里面去引用具体的类实例。</span></span><br><span class="line">  <span class="comment">//因为Driver类的构造函数中有传入参数的声明（IVehicle），因此DI会在注册列表中去找你的IVihecle，以及与之对应的类。</span></span><br><span class="line">  driver.Drive();</span><br><span class="line"> &#125;</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h3 id="通过反射实现更松的耦合"><a href="#通过反射实现更松的耦合" class="headerlink" title="通过反射实现更松的耦合"></a>通过反射实现更松的耦合</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="keyword">using</span> System;</span><br><span class="line"><span class="keyword">using</span> System.Runtime.Loader;</span><br><span class="line"></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">ReflectionStudy</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span></span><br><span class="line">        &#123;</span><br><span class="line">            Console.WriteLine();</span><br><span class="line">            <span class="comment">//在程序路径下创建Animals文件夹</span></span><br><span class="line">            <span class="keyword">var</span> folder = Path.Combine(Environment.CurrentDirectory, <span class="string">&quot;Animals&quot;</span>);</span><br><span class="line">            <span class="comment">//获取Animals文件夹里面的文件</span></span><br><span class="line">            <span class="keyword">var</span> files = Directory.GetFiles(folder);</span><br><span class="line">            <span class="comment">//创建动物的集合</span></span><br><span class="line">            <span class="keyword">var</span> animalTypes = <span class="keyword">new</span> List&lt;Type&gt;();</span><br><span class="line">            <span class="keyword">foreach</span> (<span class="keyword">var</span> <span class="keyword">file</span> <span class="keyword">in</span> files)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//将文件夹内的文件整合成一个assembly类型的实例</span></span><br><span class="line">                <span class="keyword">var</span> assembly = AssemblyLoadContext.Default.LoadFromAssemblyPath(<span class="keyword">file</span>);</span><br><span class="line">                <span class="comment">//获得assembly里面，每个元素的所有信息（属性和方法等）</span></span><br><span class="line">                <span class="keyword">var</span> types = assembly.GetTypes();</span><br><span class="line">                <span class="comment">//将每个符合要求的type类型加到我们需要的type集合当中去。</span></span><br><span class="line">                <span class="keyword">foreach</span> (<span class="keyword">var</span> t <span class="keyword">in</span> types)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="keyword">if</span> (t.GetMethod(<span class="string">&quot;Voice&quot;</span>) != <span class="literal">null</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        animalTypes.Add(t);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (<span class="literal">true</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">//将animalsType中的动物逐一打印出名字</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>; i &lt; animalTypes.Count; i++)</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">$&quot;<span class="subst">&#123;i + <span class="number">1</span>&#125;</span>。<span class="subst">&#123;animalTypes[i].Name&#125;</span>&quot;</span>);</span><br><span class="line">                &#125;</span><br><span class="line">                Console.WriteLine(<span class="string">&quot;=========================&quot;</span>);</span><br><span class="line">                <span class="comment">//选择动物，然后判断是否超出范围，没有则为其选择对应的动物</span></span><br><span class="line">                Console.WriteLine(<span class="string">&quot;Please choose animal:&quot;</span>);</span><br><span class="line">                <span class="built_in">int</span> index = <span class="built_in">int</span>.Parse(Console.ReadLine());</span><br><span class="line">                <span class="keyword">if</span> (index &gt; animalTypes.Count || index &lt; <span class="number">1</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    Console.WriteLine(<span class="string">&quot;No such an animal. Try again!&quot;</span>);</span><br><span class="line">                    <span class="keyword">continue</span>;                    </span><br><span class="line">                &#125;;</span><br><span class="line">                <span class="built_in">int</span> Clicktimes = <span class="built_in">int</span>.Parse(Console.ReadLine());</span><br><span class="line">                <span class="comment">//获取对应动物类型的typeinfo信息，然后创建反射。</span></span><br><span class="line">                <span class="keyword">var</span> t = animalTypes[index - <span class="number">1</span>];</span><br><span class="line">                <span class="comment">//获取t中，我们需要的方法。</span></span><br><span class="line">                <span class="keyword">var</span> m = t.GetMethod(<span class="string">&quot;Voice&quot;</span>);</span><br><span class="line">                <span class="comment">//创建object实例o，并通过它来调用t实例的方法或者属性</span></span><br><span class="line">                <span class="keyword">var</span> o = Activator.CreateInstance(t);</span><br><span class="line">                <span class="comment">//将o传给新创建的object，然后触发m所反射的方法</span></span><br><span class="line">                m.Invoke(o, <span class="keyword">new</span> <span class="built_in">object</span>[] &#123; Clicktimes &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>Assembly</strong> 类可以加载以下类型的文件：<br>.exe 文件（可执行文件）<br>.dll 文件（动态链接库）<br>.winmd 文件（Windows Metadata 文件）<br>特定平台的程序集（如 .a、.so、.dylib）<br>加载这些文件时，Assembly 类会解析文件中的元数据，并允许你通过反射访问其中的类型、方法等信息。</p>
<ul>
<li><strong>.dll文件制作</strong><br>需要另起一个工程，选择class lib。</li>
<li>** SDK制作**<br>在总解决方案中，添加Interface工程</li>
<li><strong>制作SDK插件</strong><br>在项目中添加依赖（dependence）中，选择browse，引用即可。</li>
</ul>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">Animals.Lib2</span> &#123;</span><br><span class="line"> [<span class="meta">Unfinished</span>]</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Cow</span> : <span class="title">IAnimal</span> </span><br><span class="line"> &#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Voice</span>(<span class="params"><span class="built_in">int</span> times</span>)</span> </span><br><span class="line">  &#123;</span><br><span class="line">   <span class="keyword">for</span> (inti=<span class="number">0</span>; i &lt; times; i++)</span><br><span class="line">   &#123;</span><br><span class="line">    Console.WriteLine(<span class="string">&quot;Moo!&quot;</span>);</span><br><span class="line">   &#125;</span><br><span class="line">  &#125;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li><strong>Attribute</strong><br>在制作插件的过程中，未完成的部分，用[Unfinished]标注，最后在主程序这边会过滤掉。<br>前提是，在SDK接口开发中，声明一个Unfinished的特性，声明如下：<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">namespace</span> <span class="title">BabyStroller.SDK</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="keyword">class</span> <span class="title">UnfinishedAttribute</span> : <span class="title">Attribute</span> &#123;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>if continue</p>
<p>当我们采用接口和SDK了之后，代码会发生改动<br>比如过滤无效类型：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">foreach</span> (<span class="keyword">var</span> t <span class="keyword">in</span> types) </span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">if</span> (t.GetInterfaces().Contains(<span class="keyword">typeof</span>(IAnimal))) </span><br><span class="line"> &#123;</span><br><span class="line">  <span class="keyword">var</span> isUnfinished = t.GetCustomAttributes(<span class="literal">false</span>).Any(a   =&gt; a.GetType() == <span class="keyword">typeof</span>(UnfinishedAttribute)&#125;;</span><br><span class="line">  <span class="keyword">if</span> (isUnfinished) <span class="keyword">continue</span>;</span><br><span class="line">  animalTypes.Add(t);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以及最调用时：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">int</span> times = <span class="built_in">int</span>.Parse(Console.ReadLine()&#125;;</span><br><span class="line"><span class="keyword">var</span> t = animalTypes[index - <span class="number">1</span>];</span><br><span class="line"><span class="keyword">var</span> m = t.GetMethod(<span class="string">&quot;Voice&quot;</span>);</span><br><span class="line"><span class="keyword">var</span> o = Activator.Createlnstance(t);</span><br><span class="line"><span class="keyword">var</span> a = o <span class="keyword">as</span> IAnimal;</span><br><span class="line">a.Voice(times);</span><br></pre></td></tr></table></figure>

<blockquote>
<p>接口<code>IAnimal</code> 定义了 <code>Voice </code>方法签名，例如：</p>
</blockquote>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IAnimal</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">Voice</span>(<span class="params"><span class="built_in">int</span> times</span>)</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>类实现接口：<br>假设有一个类<code>Dog</code>实现了 IAnimal 接口，并提供了 Voice 方法的实现：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Dog</span> : <span class="title">IAnimal</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">Voice</span>(<span class="params"><span class="built_in">int</span> times</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        Console.WriteLine(<span class="string">$&quot;The dog barks <span class="subst">&#123;times&#125;</span> times.&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这个类实现了 IAnimal 接口，提供了 Voice 方法的具体实现。<br><code>var o = Activator.CreateInstance(t);</code><br>o 是 Dog 类型的实例（如果 t 是 Dog）。此时，o 既是 Dog 类型的对象，也是 IAnimal 类型的对象，因为 Dog 实现了 IAnimal 接口。<br>接口转换和方法调用：你将 o 强制转换为 IAnimal 类型：<br><code>var a = o as IAnimal;</code><br>如果 o 实现了 IAnimal 接口，转换会成功，a 就变成了一个 IAnimal 类型的引用，指向 o。然后你可以调用 a.Voice(times)，实际上是在调用 Dog 类中实现的 Voice 方法。</p>
<h1 id="泛型、partial类、枚举、结构体"><a href="#泛型、partial类、枚举、结构体" class="headerlink" title="泛型、partial类、枚举、结构体"></a>泛型、partial类、枚举、结构体</h1><h2 id="泛型（generic）"><a href="#泛型（generic）" class="headerlink" title="泛型（generic）"></a>泛型（generic）</h2><p>为什么需要泛型：避免成员膨胀或者类型膨胀<br>正交性：泛型类型（类&#x2F;接口&#x2F;委托&#x2F;…）、泛型成员（属性&#x2F;方法&#x2F;字段&#x2F;…） </p>
<h3 id="泛型类型"><a href="#泛型类型" class="headerlink" title="泛型类型"></a>泛型类型</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span>&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>) <span class="keyword">args</span>)</span> &#123;</span><br><span class="line">  Apple apple=<span class="keyword">new</span> AppleO&#123;Color= <span class="string">&quot;Red&quot;</span>&#125;;</span><br><span class="line">  Book book = <span class="keyword">new</span> BookO &#123;Name = <span class="string">&quot;New Book&quot;</span>&#125;;</span><br><span class="line">  Box&lt;Apple&gt; box1 = <span class="keyword">new</span> Box&lt;Apple&gt;()&#123;Cargo = apple&#125;;</span><br><span class="line">  Box&lt;Book&gt; box2=<span class="keyword">new</span> Box&lt;Book&gt;Q&#123;Cargo = book&#125;;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Apple</span> &#123;</span><br><span class="line"><span class="keyword">public</span> <span class="built_in">string</span> Color &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Book</span> &#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Box</span>&lt;<span class="title">TCargo</span>&gt;&#123;</span><br><span class="line"> <span class="keyword">public</span> TCargo Cargo &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h3 id="泛型接口"><a href="#泛型接口" class="headerlink" title="泛型接口"></a>泛型接口</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span>&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>) <span class="keyword">args</span>)</span> &#123;</span><br><span class="line">  Student&lt;<span class="built_in">int</span>&gt; stu = <span class="keyword">new</span> Student&lt;<span class="built_in">int</span>&gt;();</span><br><span class="line">  stu.ID = <span class="number">101</span>;</span><br><span class="line">  stu.Name= <span class="string">&quot;Timothy&quot;</span>;</span><br><span class="line"> &#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">interface</span> <span class="title">IUnique</span>&lt;<span class="title">Tld</span>&gt; &#123;</span><br><span class="line"> TId ID&#123;<span class="keyword">get</span>;<span class="keyword">set</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title">Student</span>&lt;<span class="title">TId</span>&gt;:<span class="title">lUnique</span>&lt;<span class="title">TId</span>&gt; &#123;</span><br><span class="line"> <span class="keyword">public</span> TId ID &#123; <span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="built_in">string</span> Name &#123;<span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="泛型集合"><a href="#泛型集合" class="headerlink" title="泛型集合"></a>泛型集合</h3><p>带有一个类型参数的泛型类型</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span> &#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span> &#123;</span><br><span class="line"> IList&lt;<span class="built_in">int</span>&gt; list = <span class="keyword">new</span> List&lt;<span class="built_in">int</span>&gt;();</span><br><span class="line"> <span class="keyword">for</span> (<span class="built_in">int</span> i = <span class="number">0</span>;i&lt;<span class="number">100</span>; i++) &#123;</span><br><span class="line">  list.Add(i);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="keyword">foreach</span> (<span class="keyword">var</span> item <span class="keyword">in</span> list) &#123;</span><br><span class="line">  Console.WriteLine(item);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>带有两个类型参数的泛型类型</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Dictionary&lt;<span class="built_in">int</span>, <span class="built_in">string</span>&gt; dict = <span class="keyword">new</span> Dictionary&lt;<span class="built_in">int</span>, <span class="built_in">string</span>&gt;</span><br></pre></td></tr></table></figure>

<h3 id="泛型方法"><a href="#泛型方法" class="headerlink" title="泛型方法"></a>泛型方法</h3><figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span>&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>) <span class="keyword">args</span>)</span> &#123;</span><br><span class="line">  <span class="built_in">int</span>[] a1 = &#123;<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>&#125;;</span><br><span class="line">  <span class="built_in">int</span>[] a2 = &#123;<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>,<span class="number">6</span>&#125;;</span><br><span class="line">  <span class="built_in">double</span>[] a3 = &#123;<span class="number">1.1</span>, <span class="number">2.2</span>, <span class="number">3.3</span>, <span class="number">4.4</span>, <span class="number">5.5</span>&#125;;</span><br><span class="line">  <span class="built_in">double</span>[] a4 = &#123;<span class="number">1.1</span>, <span class="number">2.2</span>, <span class="number">3.3</span>, <span class="number">4.4</span>, <span class="number">5.5</span>, <span class="number">6.6</span>&#125;;</span><br><span class="line">  <span class="keyword">var</span> result=Zip(a1,a2);</span><br><span class="line">  <span class="comment">//var result=Zip(a3,a4);</span></span><br><span class="line">  Console.WriteLine(<span class="built_in">string</span>.Join(<span class="string">&quot;,&quot;</span>, result)&#125;;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//方法：把两个数组组合成一个数组。</span></span><br><span class="line"><span class="function"><span class="keyword">static</span> T[] <span class="title">Zip</span>&lt;<span class="title">T</span>&gt;(<span class="params">T[] a, T[] b</span>)</span>&#123;</span><br><span class="line"> T[] zipped = <span class="keyword">new</span> T[a.Length + b.Length];</span><br><span class="line"> <span class="built_in">int</span> ai = <span class="number">0</span>, bi = <span class="number">0</span>, zi = <span class="number">0</span>;</span><br><span class="line"> <span class="keyword">do</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (ai &lt; a.Length) zipped[zi++]= a[ai++];</span><br><span class="line">  <span class="keyword">if</span> (bi &lt; b.Length) zipped[zi++] = b[bi++];</span><br><span class="line"> &#125; </span><br><span class="line"> <span class="keyword">while</span> (ai &lt; a.Length || bi &lt; b.Length);</span><br><span class="line"> <span class="keyword">return</span> zipped;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="泛型委托"><a href="#泛型委托" class="headerlink" title="泛型委托"></a>泛型委托</h3><p>Action泛型委托</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>) <span class="keyword">args</span>)</span> </span><br><span class="line"> &#123;</span><br><span class="line">  <span class="comment">//Action泛型委托声明的方式和Action普通委托声明方式有差异。</span></span><br><span class="line">  Action&lt;<span class="built_in">string</span>&gt; a1 = Say;</span><br><span class="line">  <span class="comment">//Action a1 = new Action(Say)</span></span><br><span class="line">  a1();</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Say</span>(<span class="params"><span class="built_in">string</span> str</span>)</span></span><br><span class="line"> &#123;</span><br><span class="line">  Console.WriteLine(...);</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Mul</span>(<span class="params"><span class="built_in">int</span> x</span>)</span></span><br><span class="line"> &#123;</span><br><span class="line">  ...;</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>Func泛型委托</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>) <span class="keyword">args</span>)</span> </span><br><span class="line"> &#123;</span><br><span class="line">  Func&lt;<span class="built_in">double</span>,<span class="built_in">double</span>,<span class="built_in">double</span>&gt; func1 = Add;</span><br><span class="line">  <span class="keyword">var</span> result = func1(<span class="number">100</span>, <span class="number">200</span>);</span><br><span class="line">  Console.WriteLine(result); </span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">static</span> <span class="built_in">int</span> <span class="title">Add</span>(<span class="params"><span class="built_in">int</span> a,<span class="built_in">int</span> b</span>)</span></span><br><span class="line"> &#123;</span><br><span class="line">  ...;</span><br><span class="line"> &#125;</span><br><span class="line"> <span class="function"><span class="keyword">static</span> <span class="built_in">double</span> <span class="title">Add</span>(<span class="params"><span class="built_in">double</span> a,<span class="built_in">double</span> b</span>)</span></span><br><span class="line"> &#123;</span><br><span class="line">  ...;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>泛型委托与lambda表达式：<code>Func&lt;double,double,double&gt; func1 = &#123;a, b&#125;=&gt;&#123;return a+b;&#125;;</code><br>可以简化语句，节省声明方法所可能污染代码的可能。</p>
<h2 id="partial类"><a href="#partial类" class="headerlink" title="partial类"></a>partial类</h2><p>减少类的派生，当原类会自动更新覆盖等时，把自己添加的方法等放到其他名称空间下，则不会被删除或者重写。</p>
<p>partial类必须要保证和原类型在同一个名称空间之下。</p>
<h2 id="枚举"><a href="#枚举" class="headerlink" title="枚举"></a>枚举</h2><p>枚举的每个值都有大小，大小也可以自定义设置。<br><code>Console.WriteLine((int)Level.Employee);</code></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">enum</span> Level</span><br><span class="line">&#123;</span><br><span class="line"> Employee = <span class="number">100</span>,</span><br><span class="line"> Boss = <span class="number">200</span>,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"><span class="doctag">///</span><span class="doctag">///</span><span class="doctag">///</span><span class="doctag">///</span><span class="doctag">///</span><span class="doctag">///</span><span class="doctag">///</span><span class="doctag">///</span><span class="doctag">///</span>//</span></span><br><span class="line"><span class="built_in">enum</span> Level</span><br><span class="line">&#123;</span><br><span class="line"> Employee = <span class="number">100</span>,</span><br><span class="line"> Boss,</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//不给BOSS,额外设定值的话，那么bOSS是101.</span></span><br></pre></td></tr></table></figure>
<p>枚举的比特位编程</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>) <span class="keyword">args</span>)</span> </span><br><span class="line"> &#123;</span><br><span class="line">  <span class="comment">//假设这个人四个技能都会。</span></span><br><span class="line">  person.Skill = Skill.Drive | Skill.Cook| Skill.Program| SkiTeach;</span><br><span class="line">  Console.WriteLine();</span><br><span class="line">  <span class="comment">//按或运算符计算。</span></span><br><span class="line"> &#125;</span><br><span class="line"><span class="built_in">enum</span> Skill </span><br><span class="line">&#123;</span><br><span class="line"> Drive = <span class="number">1</span>,</span><br><span class="line"> Cook=<span class="number">2</span>,</span><br><span class="line"> Program=<span class="number">4</span>,</span><br><span class="line"> Teach=<span class="number">8</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">class</span> <span class="title">Person</span></span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">public</span> Skill skill;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="结构体（struct）"><a href="#结构体（struct）" class="headerlink" title="结构体（struct）"></a>结构体（struct）</h2><p>结构体是值类型，存放值类型数据。<br>装箱与拆箱操作：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">internal</span> <span class="keyword">class</span> <span class="title">Program</span> </span><br><span class="line">&#123;</span><br><span class="line"> <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>) <span class="keyword">args</span>)</span> </span><br><span class="line"> &#123;</span><br><span class="line">  Student student = <span class="keyword">new</span> Student(KID = <span class="number">101</span>, Name = <span class="string">&quot;Timtohy223;</span></span><br><span class="line"><span class="string">  object object = student;//装箱</span></span><br><span class="line"><span class="string">  Student student2 = (Student) obj;//拆箱</span></span><br><span class="line"><span class="string">  Console.WriteLine($&quot;</span><span class="meta">#&#123;student2.ID&#125; Name:(student2Name&#125;&quot;)</span></span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">struct</span> Student </span><br><span class="line">&#123;</span><br><span class="line"> <span class="keyword">public</span> <span class="built_in">int</span> ID &#123; <span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line"> <span class="keyword">public</span> <span class="built_in">string</span> Name &#123; <span class="keyword">get</span>; <span class="keyword">set</span>;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>结构体对象，进行复制时，是完全复制了其所有数据，而不是只复制了其引用的地址。<br>结构体类型，只能由接口派生。<br>结构体不能拥有显示的无参构造器：<code>public Studnt()&#123;&#125;</code>.（备注，有参的可以。）</p>
<h1 id="LINQ、lambda表达式与委托"><a href="#LINQ、lambda表达式与委托" class="headerlink" title="LINQ、lambda表达式与委托"></a>LINQ、lambda表达式与委托</h1><h2 id="lambda"><a href="#lambda" class="headerlink" title="lambda"></a>lambda</h2><ul>
<li>匿名方法</li>
<li>Inline方法</li>
</ul>
<p><strong>泛型委托的类型推断</strong></p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//两种表达方式：</span></span><br><span class="line"><span class="comment">//Func&lt;int, int, int&gt; func = new Func&lt;int,int,int&gt;((a, b) =&gt; &#123; return a + b;&#125;);</span></span><br><span class="line">Func&lt;<span class="built_in">int</span>, <span class="built_in">int</span>, <span class="built_in">int</span>&gt; func = (a, b) =&gt; &#123; <span class="keyword">return</span> a + b;&#125;;</span><br><span class="line"><span class="built_in">int</span> res = func(<span class="number">100</span>, <span class="number">200</span>);</span><br><span class="line">Console.WriteLine(res);</span><br><span class="line">func=(x,y)=&gt;&#123;returnx</span><br><span class="line">res = func(<span class="number">3</span>,<span class="number">4</span>);</span><br><span class="line">y;&#125;;</span><br><span class="line">Console.WriteLine(res);</span><br></pre></td></tr></table></figure>
<p>另外一种使用方式：</p>
<figure class="highlight c#"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title">Program</span> </span><br><span class="line">&#123;</span><br><span class="line"> <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">Main</span>(<span class="params"><span class="built_in">string</span>[] <span class="keyword">args</span></span>)</span> </span><br><span class="line"> &#123;</span><br><span class="line">  DoSomeCalc&lt;<span class="built_in">int</span>&gt;((<span class="built_in">int</span> a, <span class="built_in">int</span> b) =&gt; (<span class="keyword">return</span> a b; &#125;, <span class="number">100</span>,<span class="number">200</span>);</span><br><span class="line">  <span class="comment">//高级写法：</span></span><br><span class="line">  <span class="comment">//DoSomeCalc((a,b) =&gt; (return a b; &#125;, 100,200);</span></span><br><span class="line">  <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">DoSomeCalc</span>&lt;<span class="title">T</span>&gt;(<span class="params">Func&lt;T, T, T  T&gt; func,T x, Ty</span>)</span></span><br><span class="line"> &#123;</span><br><span class="line">  T res=func(x,y);</span><br><span class="line">  Console.WriteLine(res);</span><br><span class="line"> &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="LINQ-NET-Language-Integrated-Query"><a href="#LINQ-NET-Language-Integrated-Query" class="headerlink" title="LINQ(.NET Language Integrated Query)"></a>LINQ(.NET Language Integrated Query)</h2><p>将C#语句转换为sql语句，进行查询，但是sql的查询会更准确，LINQ只是临时简单使用。<br>……..</p>
</div>
    </div>

    <div class="post-meta">
        <i>
        
            <span>2025-04-21</span>
            
            
             
        
        </i>
    </div>
    <br>
    
    
        
            
    
            <div class="post-footer-pre-next">
                
                    <span>上一篇：<a href='/2025/04/21/Wwise%20Tour%E5%A3%B0%E9%9F%B3%E8%AE%BE%E8%AE%A1%E5%88%86%E4%BA%AB/'></a></span>
                

                
                    <span class="post-footer-pre-next-last-span-right">下一篇：<a href="/2025/04/21/%E4%B8%80%E7%BD%90%E7%9B%90%E9%9F%B3%E6%95%88%E8%AE%BE%E8%AE%A1%E8%AF%BE%E7%A8%8B/"></a>
                    </span>
                
            </div>
    
        
    

    
        

     
</div>



                                      
                    
                    
                    <div class="footer">
    
        <span> 
            © 2002-2025 Carol 

            
                

            
        </span>
       
    
</div>



<!--这是指一条线往下的内容-->
<div class="footer-last">
    
            <span>🌊看过大海的人不会忘记海的广阔🌊</span>
            
                <span class="footer-last-span-right"><i>本站由<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/index.html">Hexo</a>驱动｜使用<a target="_blank" rel="noopener" href="https://github.com/HiNinoJay/hexo-theme-A4">Hexo-theme-A4</a>主题</i></span>
            
    
</div>


    
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.0/jquery.min.js"></script>

    <!--目录-->
    
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js" type="text/javascript" ></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.tocify/1.9.0/javascripts/jquery.tocify.min.js" type="text/javascript" ></script>
        
<script src="/js/toc.js"></script>

    

    
<script src="/js/randomHeaderContent.js"></script>

    <!--回到顶部按钮-->
    
        
<script src="/js/returnToTop.js"></script>

    

    
        
<script src="/js/returnToLastPage.js"></script>

    





<script src="/js/lightgallery/lightgallery.umd.min.js"></script>



<script src="/js/lightgallery/plugins/lg-thumbnail.umd.min.js"></script>



<script src="/js/lightgallery/plugins/lg-fullscreen.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-autoplay.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-zoom.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-rotate.umd.min.js"></script>


<script src="/js/lightgallery/plugins/lg-paper.umd.min.js"></script>




<script type="text/javascript">
     
    if (typeof lightGallery !== "undefined") {
        var options1 = {
            selector: '.gallery-item',
            plugins: [lgThumbnail, lgFullscreen, lgAutoplay, lgZoom, lgRotate, lgPager], // 启用插件
            thumbnail: true,          // 显示缩略图
            zoom: true,               // 启用缩放功
            rotate: true,             // 启用旋转功能能
            autoplay: true,        // 启用自动播放功能
            fullScreen: true,      // 启用全屏功能
            pager: false, //页码,
            zoomFromOrigin: true,   // 从原始位置缩放
            actualSize: true,       // 启用查看实际大小的功能
            enableZoomAfter: 300,    // 延迟缩放，确保图片加载完成后可缩放
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options1); // 修复选择器
    }
    
</script>


    <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script> 

                </div>
            
            
                <!-- 回到顶部的按钮-->  
                <div class="progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
            
                <!-- 返回的按钮-->  
                <div class="return-to-last-progress-wrap shadow-drop-2-bottom">
                    <svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
                        <path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
                    </svg>
                </div>
            
    </body>
</html>